# =============================================================================
# MesaYA Backend (NestJS) - Docker Compose
# =============================================================================
# IMPORTANTE: Ejecutar primero el docker-compose.yml de la ra√≠z del proyecto
# para levantar Kafka antes de este servicio.
#
# Uso:
#   cd ../ && docker compose up -d   # Levantar Kafka primero
#   docker compose up -d             # Luego levantar este servicio
# =============================================================================

services:
  app:
    build: .
    container_name: mesaya-backend
    env_file:
      - .env
    environment:
      KAFKA_BROKER: kafka:9092
      KAFKA_CLIENT_ID: mesa-ya-service
      KAFKA_GROUP_ID: mesa-ya-group
      NODE_ENV: production
    ports:
      - "3000:3000"
    command: ["npm", "run", "start:prod"]
    networks:
      - mesaya-network
    restart: unless-stopped

# Conectar a la red compartida de infraestructura
networks:
  mesaya-network:
    external: true
    name: mesaya-network
